---
title: Gestión de Claves API
ogImageTitle: Gestión de Claves API de Z-Send
ogImageSubtitle: Crear y Gestionar Claves de Acceso API
---

# Gestión de Claves API

Las claves API se utilizan para autenticar sus solicitudes API de Z-Send. Cada clave puede tener diferentes niveles de permiso.

## Tipos de Permisos

Z-Send proporciona tres niveles de permiso:

| Tipo de Permiso | Descripción | Casos de Uso |
|-----------------|-------------|--------------|
| **Solo Lectura** (`read_only`) | Solo puede consultar correos y estadísticas | Análisis de datos, paneles de monitoreo |
| **Solo Envío** (`send_only`) | Puede enviar correos y consultar estado | Aplicaciones de producción (recomendado) |
| **Todos los Permisos** (`all`) | Incluye todos los permisos de operación | Herramientas de gestión, entornos de desarrollo |

import { Callout, Steps } from 'nextra/components'

<Callout type="warning">
  Por razones de seguridad, se recomienda usar el permiso "Solo Envío" en producción y evitar usar "Todos los Permisos".
</Callout>

## Crear Claves API

<Steps>

### Iniciar Sesión en la Consola

Visite la página de gestión de Z-Send en la consola de Zeabur.

### Crear Nueva Clave

1. Vaya a "Gestión de Claves API"
2. Haga clic en "Crear Clave API"
3. Ingrese el nombre de la clave (para identificación)
4. Seleccione el tipo de permiso
5. (Opcional) Restringir a dominios específicos
6. Haga clic en "Crear"

### Guardar la Clave

<Callout type="error">
  ¡La clave solo se muestra una vez durante la creación! Guárdela en un lugar seguro de inmediato.
</Callout>

Después de la creación, el sistema mostrará la clave API completa. Cópiela y guárdela de forma segura; no podrá verla nuevamente.

</Steps>

## Restricciones de Dominio

Puede restringir una clave API para que solo envíe correos desde dominios específicos para mayor seguridad:

```json
// Establecer dominios permitidos al crear la clave
{
  "name": "Production API Key",
  "permission": "send_only",
  "allowed_domains": ["yourdomain.com", "mail.yourdomain.com"]
}
```

De esta manera, incluso si la clave se filtra, los atacantes no pueden usar dominios no autorizados para enviar correos.

## Usar Claves API

### Encabezado de Solicitud HTTP

Incluya la clave en todas las solicitudes API:

```http
POST /api/v1/zsend/emails
Host: api.zeabur.com
Content-Type: application/json
Authorization: Bearer zs_your_api_key_here

{
  "from": "hello@yourdomain.com",
  ...
}
```

### Ejemplos de Código

#### JavaScript

```javascript
const apiKey = process.env.ZSEND_API_KEY;

const response = await fetch('https://api.zeabur.com/api/v1/zsend/emails', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer ' + apiKey
  },
  body: JSON.stringify({
    from: 'hello@yourdomain.com',
    to: ['user@example.com'],
    subject: 'Correo de Prueba',
    html: '<p>Contenido de Prueba</p>'
  })
});
```

#### Python

```python
import os
import requests

api_key = os.environ.get('ZSEND_API_KEY')

response = requests.post(
    'https://api.zeabur.com/api/v1/zsend/emails',
    headers={
        'Content-Type': 'application/json',
        'Authorization': 'Bearer ' + api_key
    },
    json={
        'from': 'hello@yourdomain.com',
        'to': ['user@example.com'],
        'subject': 'Correo de Prueba',
        'html': '<p>Contenido de Prueba</p>'
    }
)
```

#### Go

```go
package main

import (
    "bytes"
    "encoding/json"
    "net/http"
    "os"
)

func sendEmail() error {
    apiKey := os.Getenv("ZSEND_API_KEY")
    
    payload := map[string]interface{}{
        "from":    "hello@yourdomain.com",
        "to":      []string{"user@example.com"},
        "subject": "Correo de Prueba",
        "html":    "<p>Contenido de Prueba</p>",
    }
    
    jsonData, _ := json.Marshal(payload)
    req, _ := http.NewRequest("POST", "https://api.zeabur.com/api/v1/zsend/emails", bytes.NewBuffer(jsonData))
    req.Header.Set("Content-Type", "application/json")
    req.Header.Set("Authorization", "Bearer " + apiKey)
    
    client := &http.Client{}
    resp, err := client.Do(req)
    return err
}
```

## Rotación de Claves

La rotación regular de claves API es una buena práctica de seguridad:

<Steps>

### Crear Nueva Clave

Cree una nueva clave API mientras mantiene la clave antigua activa.

### Actualizar Configuración de Aplicación

Actualice gradualmente la clave API en sus aplicaciones a la nueva clave.

### Eliminar Clave Antigua

Después de confirmar que todas las aplicaciones se han actualizado, elimine la clave antigua.

</Steps>

Se recomienda rotar las claves cada 90 días.

## Revocar Claves

Si una clave se filtra o ya no se necesita:

1. Vaya a "Gestión de Claves API"
2. Encuentre la clave a eliminar
3. Haga clic en el botón "Eliminar"
4. Confirme la eliminación

<Callout type="warning">
  Después de eliminar una clave, todas las solicitudes API que usen esa clave fallarán inmediatamente.
</Callout>

## Mejores Prácticas de Seguridad

### 1. Usar Variables de Entorno

Nunca codifique las claves API en su código:

```javascript
// ❌ No recomendado: No codificar directamente
const apiKey = 'zs_xxxxxxxxxxxxxxxxxxxxxxxx';

// ✅ Recomendado: Usar variables de entorno
const apiKey = process.env.ZSEND_API_KEY;
```

### 2. Usar Principio de Menor Privilegio

Cree claves separadas con permisos apropiados para diferentes aplicaciones:

- **Aplicaciones de Producción**: Permiso de solo envío + restricciones de dominio
- **Análisis de Datos**: Permiso de solo lectura
- **Herramientas de Administración**: Todos los permisos (solo cuando sea necesario)

### 3. Monitorear Uso de Claves

Vea estadísticas de uso para cada clave en la consola de Z-Send:

- Cantidad de solicitudes
- Cantidad de correos enviados
- Tasa de error

Revoque la clave inmediatamente si se detecta un uso anormal.

### 4. No Compartir Claves

Cree claves separadas para cada aplicación y entorno (desarrollo/producción) para facilitar el seguimiento y la gestión.

## Solución de Problemas

### 401 Unauthorized

```json
{
  "error": "unauthorized",
  "message": "Invalid or missing API key"
}
```

**Posibles causas**:
- La clave API es incorrecta o ha sido eliminada
- El formato del encabezado de solicitud es incorrecto (debe ser `Authorization: Bearer <token>`)
- La clave tiene espacios al principio/final o falta el prefijo `Bearer`

### 403 Forbidden

```json
{
  "error": "permission denied",
  "message": "API key does not have permission to send from this domain"
}
```

**Posibles causas**:
- Permisos de clave insuficientes (por ejemplo, usar clave de solo lectura para enviar correos)
- El dominio del remitente no está en la lista permitida de la clave
- El dominio no está verificado

### 429 Too Many Requests

```json
{
  "error": "too many requests",
  "message": "Rate limit exceeded"
}
```

**Soluciones**:
- Implementar mecanismos de limitación y reintento de solicitudes
- Considere actualizar su cuenta para obtener límites de tasa más altos
- Use la API de envío por lotes para reducir el número de solicitudes
